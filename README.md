# å°æ™ºå°æ™º å¤šæ¨¡æ€èŠå¤©ç³»ç»Ÿ

åŸºäº LM Studio çš„æ™ºèƒ½å¤šæ¨¡æ€èŠå¤©åŠ©æ‰‹ï¼Œæ”¯æŒ PDF æ‰«æè¯†åˆ«ã€å›¾ç‰‡æ–‡å­—æå–ã€è¯­éŸ³å¯¹è¯ç­‰åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¤– **æ™ºèƒ½å¯¹è¯**: åŸºäº Qwen3-32B æ¨¡å‹çš„è‡ªç„¶è¯­è¨€å¯¹è¯
- ğŸ“„ **PDF æ‰«æ**: æ”¯æŒ PDF æ–‡æ¡£å†…å®¹è¯†åˆ«å’Œåˆ†æ
- ğŸ–¼ï¸ **å›¾ç‰‡è¯†åˆ«**: OCR æ–‡å­—æå–ï¼Œæ”¯æŒä¸­è‹±æ–‡æ··åˆè¯†åˆ«
- ğŸ¤ **è¯­éŸ³å¯¹è¯**: åŸºäº FunAudioLLM çš„é«˜æ€§èƒ½è¯­éŸ³è¯†åˆ«å’Œ TTS åŠŸèƒ½
- ğŸ“ **æ–‡ä»¶ä¸Šä¼ **: æ‹–æ‹½ä¸Šä¼ ï¼Œæ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼
- ğŸŒ **è·¨å¹³å°**: å‰åç«¯åˆ†ç¦»ï¼Œæ˜“äºæ‰©å±•åˆ°å°ç¨‹åºå’Œ APP
- ğŸ¨ **ç°ä»£åŒ– UI**: ä½¿ç”¨ shadcn-ui ç»„ä»¶åº“ï¼Œæä¾›ä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒ
- ğŸ‘¤ **ç”¨æˆ·éš”ç¦»**: æ¯ä¸ªç”¨æˆ·æ‹¥æœ‰ç‹¬ç«‹çš„èŠå¤©å†å²å’ŒçŸ¥è¯†åº“ï¼Œæ•°æ®å®Œå…¨éš”ç¦»
- ğŸ” **å®‰å…¨è®¤è¯**: é›†æˆè‹¥ä¾Gatewayèº«ä»½éªŒè¯ï¼Œæ”¯æŒå¤šç§Ÿæˆ·æ¶æ„
- ğŸ§  **ä¸ªäººçŸ¥è¯†åº“**: ç”¨æˆ·å¯ä¸Šä¼ æ–‡æ¡£å»ºç«‹ä¸“å±çŸ¥è¯†åº“ï¼Œæ”¯æŒè¯­ä¹‰æ£€ç´¢
- ğŸ’¾ **æ•°æ®æŒä¹…åŒ–**: SQLite + ChromaDB åŒæ•°æ®åº“æ¶æ„ï¼Œä¿è¯æ•°æ®å®‰å…¨
- ğŸ”„ **å®æ—¶åŒæ­¥**: å¯¹è¯åˆ—è¡¨ä¸åç«¯å®æ—¶åŒæ­¥ï¼Œæ”¯æŒå¤šè®¾å¤‡æ•°æ®ä¸€è‡´æ€§

## æŠ€æœ¯æ ˆ

### åç«¯
- **FastAPI**: é«˜æ€§èƒ½ Python Web æ¡†æ¶
- **SQLite**: è½»é‡çº§æ•°æ®åº“ï¼Œç”¨äºç”¨æˆ·æ•°æ®å’ŒèŠå¤©å†å²å­˜å‚¨
- **ChromaDB**: å‘é‡æ•°æ®åº“ï¼Œæ”¯æŒç”¨æˆ·éš”ç¦»çš„æ–‡æ¡£æ£€ç´¢
- **Sentence Transformers**: è¯­ä¹‰åµŒå…¥æ¨¡å‹ï¼Œç”¨äºæ–‡æ¡£å‘é‡åŒ–
- **ç”¨æˆ·è®¤è¯ä¸­é—´ä»¶**: åŸºäºè‹¥ä¾Gatewayçš„ç”¨æˆ·èº«ä»½éªŒè¯
- **FunAudioLLM**: é«˜æ€§èƒ½è¯­éŸ³è¯†åˆ«å¼•æ“ï¼ˆæ¯” Whisper å¿« 15 å€ï¼‰
- **Edge-TTS**: å¾®è½¯è¯­éŸ³åˆæˆæœåŠ¡
- **PyPDF2 & python-docx**: å¤šæ ¼å¼æ–‡æ¡£è§£æ
- **LM Studio API**: æœ¬åœ°å¤§è¯­è¨€æ¨¡å‹æœåŠ¡
- **Nacos**: å¾®æœåŠ¡æ³¨å†Œä¸é…ç½®ä¸­å¿ƒ

### å‰ç«¯
- **Vue 3**: æ¸è¿›å¼ JavaScript æ¡†æ¶
- **TypeScript**: ç±»å‹å®‰å…¨çš„ JavaScript
- **Vite**: å¿«é€Ÿçš„å‰ç«¯æ„å»ºå·¥å…·
- **Tailwind CSS**: å®ç”¨ä¼˜å…ˆçš„ CSS æ¡†æ¶
- **shadcn-ui**: ç°ä»£åŒ– UI ç»„ä»¶åº“ï¼ˆVue ç‰ˆæœ¬ï¼‰
- **Lucide Vue**: ç²¾ç¾çš„å›¾æ ‡åº“
- **Pinia**: Vue 3 çŠ¶æ€ç®¡ç†åº“
  

### ç•Œé¢ç¤ºä¾‹
![image](https://gitee.com/githaohao/xzxz-lm/raw/main/docs/%E6%88%AA%E5%B1%8F2025-05-26%20%E4%B8%8A%E5%8D%889.36.01.png)
![image](https://gitee.com/githaohao/xzxz-lm/raw/main/docs/%E6%88%AA%E5%B1%8F2025-06-04%20%E4%B8%8B%E5%8D%882.30.51.png)
![image](https://gitee.com/githaohao/xzxz-lm/raw/main/docs/%E6%88%AA%E5%B1%8F2025-06-04%20%E4%B8%8B%E5%8D%882.31.08.png)
![image](https://gitee.com/githaohao/xzxz-lm/raw/main/docs/%E6%88%AA%E5%B1%8F2025-06-04%20%E4%B8%8B%E5%8D%882.31.20.png)
![image](https://gitee.com/githaohao/xzxz-lm/raw/main/docs/%E6%88%AA%E5%B1%8F2025-06-04%20%E4%B8%8B%E5%8D%882.31.30.png)
![image](https://gitee.com/githaohao/xzxz-lm/raw/main/docs/%E6%88%AA%E5%B1%8F2025-05-26%20%E4%B8%8A%E5%8D%889.36.30.png)
![image](https://gitee.com/githaohao/xzxz-lm/raw/main/docs/%E6%88%AA%E5%B1%8F2025-05-26%20%E4%B8%8A%E5%8D%889.36.45.png)
![image](https://gitee.com/githaohao/xzxz-lm/raw/main/docs/%E6%88%AA%E5%B1%8F2025-05-26%20%E4%B8%8A%E5%8D%889.36.53.png)
![image](https://gitee.com/githaohao/xzxz-lm/raw/main/docs/%E6%88%AA%E5%B1%8F2025-05-26%20%E4%B8%8A%E5%8D%889.37.13.png)
![image](https://gitee.com/githaohao/xzxz-lm/raw/main/docs/%E6%88%AA%E5%B1%8F2025-05-26%20%E4%B8%8A%E5%8D%889.37.22.png)

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### å¾®æœåŠ¡æ¨¡å¼å¯åŠ¨ï¼ˆæ¨èï¼‰

```bash
# 1. å¯åŠ¨Nacosé›†æˆç‰ˆæœ¬
./scripts/start_with_nacos.sh

# 2. å¯åŠ¨NestJSèŠå¤©å†å²æœåŠ¡
cd nestjs-chat-service
./start.sh

# 3. æˆ–ä½¿ç”¨Docker Composeå¯åŠ¨å®Œæ•´å¾®æœåŠ¡ç¯å¢ƒ
docker-compose -f docker-compose.nacos.yml up -d
```

### ç‹¬ç«‹æ¨¡å¼å¯åŠ¨

#### ç¯å¢ƒå˜é‡è®¾ç½®ï¼ˆæ¨èï¼‰

ä¸ºäº†é¿å… tokenizers å¹¶è¡Œå¤„ç†è­¦å‘Šï¼Œå»ºè®®å…ˆè®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
# æ–¹æ³•1ï¼šä½¿ç”¨æä¾›çš„è„šæœ¬ï¼ˆæ¨èï¼‰
source scripts/set_env.sh

# æ–¹æ³•2ï¼šæ‰‹åŠ¨è®¾ç½®
export TOKENIZERS_PARALLELISM=false
export PYTORCH_ENABLE_MPS_FALLBACK=1  # Apple Silicon ç”¨æˆ·
export MPS_MEMORY_FRACTION=0.8        # Apple Silicon ç”¨æˆ·
```

#### å¯åŠ¨æœåŠ¡

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- Node.js 18+
- pnpmï¼ˆæ¨èï¼‰æˆ– npm
- LM Studio (è¿è¡Œ Qwen3-32B æ¨¡å‹)

### 1. å¯åŠ¨ LM Studio

1. ä¸‹è½½å¹¶å®‰è£… [LM Studio](https://lmstudio.ai/)
2. ä¸‹è½½ Qwen3-32B-MLX æ¨¡å‹
3. å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ï¼Œç¡®ä¿è¿è¡Œåœ¨ `http://127.0.0.1:1234/v1`

### 2. åç«¯è®¾ç½®

```bash
# è¿›å…¥åç«¯ç›®å½•
cd backend

# å®‰è£… Python ä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨åç«¯æœåŠ¡
python -m app.main
```

åç«¯å°†è¿è¡Œåœ¨ `http://localhost:8000`

### 3. å‰ç«¯è®¾ç½®

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd vue-frontend

# å®‰è£… Node.js ä¾èµ–ï¼ˆæ¨èä½¿ç”¨ pnpmï¼‰
pnpm install
# æˆ–è€…ä½¿ç”¨ npm
# npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev
# æˆ–è€…ä½¿ç”¨ npm
# npm run dev
```

å‰ç«¯å°†è¿è¡Œåœ¨ `http://localhost:3001`

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½® (.env)

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿æ–‡ä»¶
cp backend/.env.example backend/.env
```

**é‡è¦é…ç½®é¡¹ï¼š**

```bash
# æœåŠ¡IPé…ç½® - æ³¨å†Œåˆ°Nacosæ—¶ä½¿ç”¨
# å»ºè®®æ‰‹åŠ¨è®¾ç½®ä¸ºå®é™…ç½‘ç»œæ¥å£çš„IPåœ°å€
SERVICE_IP=192.168.100.24
SERVICE_PORT=8000

# NacosæœåŠ¡å‘ç°é…ç½®
NACOS_ENABLED=true
NACOS_SERVER_ADDRESSES=nacos:8848
NACOS_SERVICE_NAME=xzxz-lm-service

# LM Studioé…ç½®
LM_STUDIO_BASE_URL=http://127.0.0.1:1234/v1
LM_STUDIO_MODEL=deepseek-r1-0528-qwen3-8b-mlx@8bit
```

### IPåœ°å€é…ç½®è¯´æ˜

ç³»ç»Ÿä¼šæŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§æ£€æµ‹å’Œä½¿ç”¨IPåœ°å€ï¼š

1. **æ‰‹åŠ¨é…ç½®ä¼˜å…ˆ**ï¼šå¦‚æœåœ¨ `.env` æ–‡ä»¶ä¸­è®¾ç½®äº† `SERVICE_IP`ï¼Œç³»ç»Ÿå°†ä¼˜å…ˆä½¿ç”¨è¯¥IP
2. **è‡ªåŠ¨æ£€æµ‹è§„åˆ™**ï¼šå¦‚æœæœªé…ç½®æˆ–è®¾ç½®ä¸º `0.0.0.0`ï¼Œç³»ç»ŸæŒ‰ä»¥ä¸‹é¡ºåºè‡ªåŠ¨æ£€æµ‹ï¼š
   - ä¼˜å…ˆé€‰æ‹© `192.168.x.x` ç½‘æ®µçš„IPï¼ˆå±€åŸŸç½‘ï¼‰
   - å…¶æ¬¡é€‰æ‹© `10.x.x.x` ç½‘æ®µçš„IP
   - å†æ¬¡é€‰æ‹© `172.16-31.x.x` ç½‘æ®µçš„IP
   - æœ€åé€‰æ‹©ç¬¬ä¸€ä¸ªéå›ç¯IP

**æ¨èåšæ³•**ï¼šåœ¨ `.env` æ–‡ä»¶ä¸­æ‰‹åŠ¨è®¾ç½® `SERVICE_IP=192.168.100.24`ï¼Œé¿å…è‡ªåŠ¨æ£€æµ‹é”™è¯¯ã€‚

### ç½‘ç»œæ¥å£è°ƒè¯•

å¦‚éœ€æŸ¥çœ‹ç³»ç»Ÿæ£€æµ‹åˆ°çš„æ‰€æœ‰ç½‘ç»œæ¥å£ï¼Œå¯è®¿é—®å¥åº·æ£€æŸ¥æ¥å£ï¼š

```bash
curl http://localhost:8000/health
```

è¿”å›çš„ `network_info` å­—æ®µåŒ…å«ï¼š
- `current_ip`: å½“å‰ä½¿ç”¨çš„IP
- `configured_ip`: é…ç½®æ–‡ä»¶ä¸­çš„IP
- `all_interfaces`: æ‰€æœ‰æ£€æµ‹åˆ°çš„ç½‘ç»œæ¥å£

### å¯¹è¯åˆ—è¡¨åŒæ­¥æœºåˆ¶

ç³»ç»Ÿå®ç°äº†å‰ç«¯ä¸åç«¯çš„å¯¹è¯åˆ—è¡¨åŒå‘åŒæ­¥ï¼š

#### ğŸ”„ è‡ªåŠ¨åŒæ­¥
- **åº”ç”¨å¯åŠ¨**: è‡ªåŠ¨ä»åç«¯åŒæ­¥å¯¹è¯åˆ—è¡¨åˆ°æœ¬åœ°
- **æ™ºèƒ½åˆå¹¶**: æœ¬åœ°å¯¹è¯ä¸åç«¯ä¼šè¯è‡ªåŠ¨å…³è”ï¼Œé¿å…é‡å¤
- **ç¼“å­˜ä¼˜åŒ–**: ä¼˜å…ˆä»æœ¬åœ°ç¼“å­˜åŠ è½½ï¼Œæå‡å¯åŠ¨é€Ÿåº¦

#### ğŸ”§ æ‰‹åŠ¨åŒæ­¥
- **åˆ·æ–°æŒ‰é’®**: å¯¹è¯åˆ—è¡¨å³ä¸Šè§’çš„åˆ·æ–°æŒ‰é’®ï¼Œéšæ—¶åŒæ­¥æœ€æ–°æ•°æ®
- **çŠ¶æ€æŒ‡ç¤º**: åŒæ­¥è¿‡ç¨‹ä¸­æ˜¾ç¤ºæ—‹è½¬åŠ¨ç”»ï¼Œæä¾›æ¸…æ™°çš„ç”¨æˆ·åé¦ˆ

#### ğŸ“± å¤šè®¾å¤‡æ”¯æŒ
- **æ•°æ®ä¸€è‡´æ€§**: åŒä¸€ç”¨æˆ·åœ¨ä¸åŒè®¾å¤‡é—´ä¿æŒå¯¹è¯å†å²ä¸€è‡´
- **ç¦»çº¿ä¼˜å…ˆ**: æœ¬åœ°ä¼˜å…ˆç­–ç•¥ï¼Œå³ä½¿ç½‘ç»œå¼‚å¸¸ä¹Ÿèƒ½æ­£å¸¸ä½¿ç”¨
- **æ™ºèƒ½æ¢å¤**: ç½‘ç»œæ¢å¤åè‡ªåŠ¨åŒæ­¥å·®å¼‚æ•°æ®

#### ğŸ’¾ å­˜å‚¨ç­–ç•¥
- **æœ¬åœ°å­˜å‚¨**: localStorageç¼“å­˜å¯¹è¯åˆ—è¡¨ï¼Œæå‡åŠ è½½é€Ÿåº¦
- **åç«¯æŒä¹…åŒ–**: SQLiteæ•°æ®åº“å­˜å‚¨ç”¨æˆ·èŠå¤©å†å²
- **å¢é‡åŒæ­¥**: åªåŒæ­¥å˜æ›´çš„å¯¹è¯ï¼Œå‡å°‘ç½‘ç»œå¼€é”€

### åç«¯é…ç½® (backend/app/config.py)

```python
# LM Studio API é…ç½®
lm_studio_base_url: str = "http://127.0.0.1:1234/v1"
lm_studio_model: str = "qwen3-14b-mlx"

# OCR é…ç½®
tesseract_path: str = "/usr/local/bin/tesseract"  # Tesseract è·¯å¾„

# TTS é…ç½®
tts_voice: str = "zh-CN-XiaoxiaoNeural"  # ä¸­æ–‡å¥³å£°

# FunAudioLLM é…ç½®
funaudio_enabled: bool = True  # å¯ç”¨ FunAudioLLM
```

### å‰ç«¯é…ç½® (vue-frontend/vite.config.ts)

```typescript
// API ä»£ç†é…ç½®
export default defineConfig({
  server: {
    port: 3001,
    proxy: {
      '^/(chat|health|voice|upload|ocr|tts|rag)': {
        target: 'http://localhost:8000',
        changeOrigin: true,
      },
    },
  },
})
```

## API æ¥å£

### ğŸ¤– AIèŠå¤©æœåŠ¡ (/api/lm/*)
- `POST /api/lm/chat/stream` - æµå¼æ–‡æœ¬èŠå¤©
- `POST /api/lm/chat/multimodal/stream/processed` - å¤šæ¨¡æ€æµå¼èŠå¤©

### ğŸ¤ è¯­éŸ³åŠŸèƒ½ (/voice/*)
- `POST /voice/chat` - è¯­éŸ³å¯¹è¯
- `POST /voice/speech/synthesize` - è¯­éŸ³åˆæˆ(TTS)
- `GET /voice/engine` - è·å–è¯­éŸ³å¼•æ“çŠ¶æ€
- `DELETE /voice/conversation/{id}` - æ¸…é™¤å¯¹è¯å†å²
- `WebSocket /voice/ws/voice` - å®æ—¶è¯­éŸ³WebSocketè¿æ¥

### ğŸ“ æ–‡ä»¶å¤„ç† (/api/lm/*)
- `POST /api/lm/upload` - æ–‡ä»¶ä¸Šä¼ 
- `POST /api/lm/ocr` - OCRæ–‡å­—è¯†åˆ«

### ğŸ§  RAGæ™ºèƒ½æ£€ç´¢ (/api/lm/rag/*)
- `GET /api/lm/rag/documents` - è·å–æ–‡æ¡£åˆ—è¡¨
- `POST /api/lm/rag/search` - æ–‡æ¡£æ£€ç´¢
- `POST /api/lm/rag/process` - æ–‡æ¡£å¤„ç†
- `DELETE /api/lm/rag/documents/{id}` - åˆ é™¤æ–‡æ¡£

### ğŸ”§ ç³»ç»Ÿç›‘æ§ (/api/lm/*)
- `GET /api/lm/health` - å¥åº·æ£€æŸ¥

### ğŸ’¬ ç”¨æˆ·èŠå¤©å†å²æœåŠ¡ (/api/user/chat/*)
- `GET /api/user/chat/sessions` - è·å–ç”¨æˆ·èŠå¤©ä¼šè¯åˆ—è¡¨
- `POST /api/user/chat/sessions` - åˆ›å»ºæ–°çš„èŠå¤©ä¼šè¯
- `GET /api/user/chat/sessions/{id}` - è·å–æŒ‡å®šä¼šè¯è¯¦æƒ…
- `PUT /api/user/chat/sessions/{id}` - æ›´æ–°ä¼šè¯ä¿¡æ¯
- `DELETE /api/user/chat/sessions/{id}` - åˆ é™¤ä¼šè¯
- `PUT /api/user/chat/sessions/{id}/archive` - å½’æ¡£ä¼šè¯
- `PUT /api/user/chat/sessions/{id}/restore` - æ¢å¤ä¼šè¯
- `GET /api/user/chat/sessions/{id}/messages` - è·å–ä¼šè¯æ¶ˆæ¯åˆ—è¡¨
- `POST /api/user/chat/sessions/{id}/messages` - æ·»åŠ æ¶ˆæ¯åˆ°ä¼šè¯
- `POST /api/user/chat/messages/batch` - æ‰¹é‡æ·»åŠ æ¶ˆæ¯
- `DELETE /api/user/chat/messages/{id}` - åˆ é™¤æ¶ˆæ¯
- `GET /api/user/chat/stats` - è·å–ç”¨æˆ·èŠå¤©ç»Ÿè®¡ä¿¡æ¯
- `GET /api/user/chat/health` - èŠå¤©å†å²æœåŠ¡å¥åº·æ£€æŸ¥

### ğŸ“š ç”¨æˆ·çŸ¥è¯†åº“æœåŠ¡ (/api/user/rag/*)
- `POST /api/user/rag/documents/upload` - ä¸Šä¼ æ–‡æ¡£åˆ°ä¸ªäººçŸ¥è¯†åº“
- `GET /api/user/rag/documents` - è·å–ç”¨æˆ·æ–‡æ¡£åˆ—è¡¨
- `POST /api/user/rag/search` - åœ¨ç”¨æˆ·çŸ¥è¯†åº“ä¸­æœç´¢æ–‡æ¡£
- `DELETE /api/user/rag/documents/{id}` - åˆ é™¤ç”¨æˆ·æ–‡æ¡£
- `GET /api/user/rag/documents/{id}/chunks` - è·å–æ–‡æ¡£åˆ†å—å†…å®¹
- `GET /api/user/rag/stats` - è·å–ç”¨æˆ·RAGç»Ÿè®¡ä¿¡æ¯
- `GET /api/user/rag/health` - ç”¨æˆ·RAGæœåŠ¡å¥åº·æ£€æŸ¥

### ğŸ‘¤ è‹¥ä¾ç”¨æˆ·ç³»ç»Ÿ (/api/system/*)
- `GET /api/system/captcha` - è·å–éªŒè¯ç 
- `POST /api/system/login` - ç”¨æˆ·ç™»å½•
- `POST /api/system/logout` - é€€å‡ºç™»å½•
- `GET /api/system/getInfo` - è·å–ç”¨æˆ·ä¿¡æ¯
- `GET /api/system/user/profile` - è·å–ç”¨æˆ·èµ„æ–™
- `POST /api/system/user/profile` - æ›´æ–°ç”¨æˆ·èµ„æ–™
- `POST /api/system/user/avatar` - ä¸Šä¼ ç”¨æˆ·å¤´åƒ
- `GET /api/system/menu/list` - è·å–èœå•åˆ—è¡¨
- `GET /api/system/getRouters` - è·å–è·¯ç”±åˆ—è¡¨
- `POST /api/system/refresh` - åˆ·æ–°Token

### å¾®æœåŠ¡é›†æˆ
- **æœåŠ¡æ³¨å†Œ**: è‡ªåŠ¨æ³¨å†Œåˆ°NacosæœåŠ¡æ³¨å†Œä¸­å¿ƒ
- **é…ç½®ç®¡ç†**: æ”¯æŒä»Nacosè·å–åŠ¨æ€é…ç½®
- **å¥åº·æ£€æŸ¥**: æä¾›å¤šç§æ ¼å¼çš„å¥åº·æ£€æŸ¥ç«¯ç‚¹
- **æœåŠ¡å‘ç°**: æ”¯æŒé€šè¿‡Nacosè¿›è¡ŒæœåŠ¡å‘ç°

## é¡µé¢è·¯ç”±

- `/` - é¦–é¡µ
- `/chat` - æ–‡æœ¬èŠå¤©é¡µé¢
- `/voice-chat` - è¯¦ç»†ç‰ˆè¯­éŸ³èŠå¤©é¡µé¢
- `/simple-voice-chat` - ç®€åŒ–ç‰ˆè¯­éŸ³èŠå¤©é¡µé¢
- `/style-showcase` - shadcn-ui ç»„ä»¶å±•ç¤ºé¡µé¢

## æµ‹è¯•å·¥å…·

### å¥åº·æ£€æŸ¥ç«¯ç‚¹æµ‹è¯•
```bash
# æµ‹è¯•æ‰€æœ‰å¥åº·æ£€æŸ¥ç«¯ç‚¹
python3 scripts/test_health_endpoints.py

# æˆ–è€…ç›´æ¥æ‰§è¡Œ
./scripts/test_health_endpoints.py
```

è¯¥è„šæœ¬ä¼šæµ‹è¯•ä»¥ä¸‹ç«¯ç‚¹ï¼š
- `/health` - æ ‡å‡†å¥åº·æ£€æŸ¥
- `/status` - è¯¦ç»†ç³»ç»ŸçŠ¶æ€

## ä½¿ç”¨è¯´æ˜

1. **æ–‡æœ¬å¯¹è¯**: ç›´æ¥åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æ¶ˆæ¯
2. **æ–‡ä»¶ä¸Šä¼ **: ç‚¹å‡»é™„ä»¶æŒ‰é’®æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°èŠå¤©åŒºåŸŸ
3. **PDF è¯†åˆ«**: ä¸Šä¼  PDF æ–‡ä»¶ï¼Œç³»ç»Ÿè‡ªåŠ¨è¿›è¡Œ OCR è¯†åˆ«
4. **å›¾ç‰‡è¯†åˆ«**: ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶ï¼Œæå–å…¶ä¸­çš„æ–‡å­—å†…å®¹
5. **è¯­éŸ³å¯¹è¯**: 
   - ç‚¹å‡»ç»¿è‰²ç”µè¯æŒ‰é’®å¼€å§‹è¯­éŸ³é€šè¯
   - ç³»ç»Ÿè‡ªåŠ¨å½•éŸ³å¹¶ä½¿ç”¨ FunAudioLLM è¿›è¡Œè¯­éŸ³è¯†åˆ«
   - AI å›å¤æ”¯æŒ TTS è¯­éŸ³æ’­æ”¾
   - æ”¯æŒé™éŸ³æ§åˆ¶å’Œä¼šè¯ç®¡ç†

## æ”¯æŒçš„æ–‡ä»¶æ ¼å¼

- **æ–‡æ¡£**: PDF
- **å›¾ç‰‡**: PNG, JPG, JPEG
- **éŸ³é¢‘**: MP3, WAV, M4A

## éƒ¨ç½²è¯´æ˜

### å¾®æœåŠ¡éƒ¨ç½²ï¼ˆNacos + è‹¥ä¾Gatewayï¼‰

#### 1. å¯ç”¨NacosæœåŠ¡æ³¨å†Œ

```bash
# 1. å¤åˆ¶ç¯å¢ƒé…ç½®æ–‡ä»¶
cp backend/env.example backend/.env

# 2. ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œå¯ç”¨Nacos
vim backend/.env
# è®¾ç½® NACOS_ENABLED=true
# è®¾ç½® NACOS_SERVER_ADDRESSES=your-nacos-server:8848

# 3. ä½¿ç”¨Nacoså¯åŠ¨è„šæœ¬
./scripts/start_with_nacos.sh
```

#### 2. Docker Compose éƒ¨ç½²ï¼ˆåŒ…å«Nacosï¼‰

```bash
# å¯åŠ¨å®Œæ•´çš„å¾®æœåŠ¡ç¯å¢ƒï¼ˆåŒ…å«Nacosã€MySQLã€Redisã€Gatewayï¼‰
docker-compose -f docker-compose.nacos.yml up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose.nacos.yml ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose -f docker-compose.nacos.yml logs -f xzxz-lm-service
```

#### 3. è‹¥ä¾Gatewayé…ç½®

å°† `configs/gateway-routes.yml` ä¸­çš„é…ç½®æ·»åŠ åˆ°æ‚¨çš„è‹¥ä¾Gatewayé…ç½®ä¸­ï¼š

```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: xzxz-lm-service
          uri: lb://xzxz-lm-service
          predicates:
            - Path=/lm/**
          filters:
            - StripPrefix=1
```

#### 4. æœåŠ¡è®¿é—®

- **ç›´æ¥è®¿é—®**: `http://localhost:8000/health`
- **é€šè¿‡Gateway**: `http://gateway:8080/lm/health`
- **Nacosæ§åˆ¶å°**: `http://localhost:8848/nacos`

### ä¼ ç»ŸDockeréƒ¨ç½²

```bash
# æ„å»ºåç«¯é•œåƒ
cd backend
docker build -t xzxz-lm-backend .

# æ„å»ºå‰ç«¯é•œåƒ
cd vue-frontend
docker build -t xzxz-lm-frontend .

# ä½¿ç”¨ docker-compose å¯åŠ¨
docker-compose up -d
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. **åç«¯éƒ¨ç½²**:
   ```bash
   # ä½¿ç”¨ gunicorn éƒ¨ç½²
   gunicorn app.main:app -w 4 -k uvicorn.workers.UvicornWorker
   ```

2. **å‰ç«¯éƒ¨ç½²**:
   ```bash
   # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
   cd vue-frontend
   pnpm build
   pnpm preview
   ```

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

1. **åç«¯**: åœ¨ `backend/app/routes/` ä¸­æ·»åŠ æ–°çš„è·¯ç”±
2. **å‰ç«¯**: åœ¨ `vue-frontend/src/components/` ä¸­æ·»åŠ æ–°çš„ç»„ä»¶
3. **æœåŠ¡**: åœ¨ `backend/app/services/` ä¸­æ·»åŠ ä¸šåŠ¡é€»è¾‘
4. **é¡µé¢**: åœ¨ `vue-frontend/src/views/` ä¸­æ·»åŠ æ–°çš„é¡µé¢

### å‰ç«¯ç»„ä»¶å¼€å‘

é¡¹ç›®ä½¿ç”¨ shadcn-ui ç»„ä»¶åº“ï¼Œæ‰€æœ‰ UI ç»„ä»¶ä½äº `vue-frontend/src/components/ui/`ï¼š

- `Avatar.vue` - å¤´åƒç»„ä»¶
- `Button.vue` - æŒ‰é’®ç»„ä»¶
- `Card.vue` - å¡ç‰‡ç»„ä»¶
- `Badge.vue` - å¾½ç« ç»„ä»¶
- `Progress.vue` - è¿›åº¦æ¡ç»„ä»¶
- `Alert.vue` - è­¦å‘Šç»„ä»¶
- `Skeleton.vue` - éª¨æ¶å±ç»„ä»¶

### æ‰©å±•åˆ°ç§»åŠ¨ç«¯

é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œå¯ä»¥è½»æ¾æ‰©å±•åˆ°ï¼š
- **å°ç¨‹åº**: ä½¿ç”¨ç›¸åŒçš„ API æ¥å£
- **ç§»åŠ¨ APP**: React Native æˆ–åŸç”Ÿå¼€å‘
- **æ¡Œé¢åº”ç”¨**: Electron å°è£…

## ğŸ”„ æ¶æ„å˜æ›´è¯´æ˜

### v2.0 ç”¨æˆ·ç»‘å®šæ¶æ„å‡çº§

æœ¬ç‰ˆæœ¬è¿›è¡Œäº†é‡å¤§æ¶æ„å‡çº§ï¼Œå®ç°äº†å®Œæ•´çš„ç”¨æˆ·ç»‘å®šåŠŸèƒ½ï¼š

#### ğŸ› ï¸ æŠ€æœ¯æ ˆå‡çº§
- **å“åº”æ¨¡å‹é‡æ„**: `ChatHistoryResponse`ç±»æ”¯æŒæ³›å‹å‚æ•°åŒ–ï¼Œç»§æ‰¿`typing.Generic[T]`
- **ç±»å‹å®‰å…¨å¢å¼º**: ç»Ÿä¸€ä½¿ç”¨`TypeVar`å®ç°ç±»å‹å®‰å…¨çš„APIå“åº”
- **æ•°æ®åº“åŒå¼•æ“**: SQLite + ChromaDB å®ç°å…³ç³»å‹+å‘é‡å‹åŒå­˜å‚¨
- **ç”¨æˆ·æ•°æ®éš”ç¦»**: æ¯ä¸ªç”¨æˆ·æ‹¥æœ‰ç‹¬ç«‹çš„æ•°æ®ç©ºé—´ï¼Œç¡®ä¿éšç§å®‰å…¨

#### ğŸ—„ï¸ æ•°æ®æ¶æ„ä¼˜åŒ–
1. **ç”¨æˆ·ä¼šè¯è¡¨** (`user_chat_sessions`)
   - ç”¨æˆ·IDç´¢å¼•ï¼Œæ”¯æŒå¿«é€ŸæŸ¥è¯¢
   - ä¼šè¯çŠ¶æ€ç®¡ç†ï¼ˆæ´»è·ƒ/å½’æ¡£/åˆ é™¤ï¼‰
   - æ ‡ç­¾ç³»ç»Ÿï¼Œæ”¯æŒåˆ†ç±»ç®¡ç†

2. **ç”¨æˆ·æ¶ˆæ¯è¡¨** (`user_chat_messages`)
   - æ¶ˆæ¯é“¾å¼ç»“æ„ï¼Œæ”¯æŒå›å¤å¼•ç”¨
   - åºåˆ—å·æ’åºï¼Œä¿è¯æ¶ˆæ¯é¡ºåº
   - å¤šç±»å‹æ¶ˆæ¯æ”¯æŒï¼ˆæ–‡æœ¬/è¯­éŸ³/å›¾ç‰‡/æ–‡ä»¶ï¼‰

3. **ç”¨æˆ·æ–‡æ¡£è¡¨** (`user_documents`)
   - RAGæ–‡æ¡£å…ƒæ•°æ®ç®¡ç†
   - OCRçŠ¶æ€è¿½è¸ª
   - åˆ†å—è®¡æ•°ç»Ÿè®¡

4. **å‘é‡å­˜å‚¨** (ChromaDB)
   - ç”¨æˆ·ä¸“å±Collection: `user_{id}_docs`
   - é«˜ç»´å‘é‡æ£€ç´¢ (768ç»´åº¦)
   - è¯­ä¹‰ç›¸ä¼¼åº¦æœç´¢

#### ğŸ”Œ APIæ¶æ„å‡çº§
```
ä¼ ç»Ÿæ¶æ„: /api/chat/* (å…¨å±€å…±äº«)
æ–°æ¶æ„: /api/user/chat/* (ç”¨æˆ·ç»‘å®š)
       /api/user/rag/* (ä¸ªäººçŸ¥è¯†åº“)
```

#### ğŸ¯ æ ¸å¿ƒæ”¹è¿›
- **æ³›å‹å“åº”**: `ChatHistoryResponse[T]`æ”¯æŒä»»æ„æ•°æ®ç±»å‹
- **ç±»å‹æ£€æŸ¥**: ç¼–è¯‘æ—¶ç±»å‹éªŒè¯ï¼Œè¿è¡Œæ—¶ç±»å‹å®‰å…¨
- **ç”¨æˆ·è®¤è¯**: è‹¥ä¾Gatewayé›†æˆï¼Œè‡ªåŠ¨æå–ç”¨æˆ·ä¿¡æ¯
- **æ•°æ®éš”ç¦»**: ä¸¥æ ¼çš„ç”¨æˆ·æƒé™æ§åˆ¶ï¼Œé˜²æ­¢æ•°æ®æ³„éœ²
- **æ€§èƒ½ä¼˜åŒ–**: ç´¢å¼•ä¼˜åŒ–ã€æŸ¥è¯¢ä¼˜åŒ–ã€ç¼“å­˜æœºåˆ¶

#### ğŸ“Š å‡çº§å½±å“
- **å‰ç«¯å…¼å®¹**: æ— éœ€ä¿®æ”¹ç°æœ‰å‰ç«¯ä»£ç 
- **APIè·¯å¾„**: æ–°å¢ç”¨æˆ·ç»‘å®šAPIï¼Œä¿ç•™åŸæœ‰API
- **æ•°æ®è¿ç§»**: æ”¯æŒå¹³æ»‘æ•°æ®è¿ç§»
- **æ€§èƒ½æå‡**: ç”¨æˆ·æ•°æ®éš”ç¦»å¸¦æ¥çš„æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **LM Studio è¿æ¥å¤±è´¥**
   - æ£€æŸ¥ LM Studio æ˜¯å¦æ­£å¸¸è¿è¡Œ
   - ç¡®è®¤ç«¯å£ 1234 æœªè¢«å ç”¨
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

2. **OCR è¯†åˆ«å¤±è´¥**
   - æ£€æŸ¥å›¾ç‰‡è´¨é‡å’Œæ ¼å¼

3. **è¯­éŸ³åŠŸèƒ½å¼‚å¸¸**
   - æ£€æŸ¥ FunAudioLLM æœåŠ¡çŠ¶æ€
   - ç¡®è®¤éº¦å…‹é£æƒé™å·²æˆæƒ
   - æ£€æŸ¥éŸ³é¢‘è®¾å¤‡è¿æ¥

4. **å‰ç«¯ç¼–è¯‘é”™è¯¯**
   - ç¡®ä¿ä½¿ç”¨ Node.js 18+
   - æ¸…é™¤ç¼“å­˜ï¼š`pnpm store prune`
   - é‡æ–°å®‰è£…ä¾èµ–ï¼š`rm -rf node_modules && pnpm install`

### æ—¥å¿—æŸ¥çœ‹

```bash
# åç«¯æ—¥å¿—
tail -f backend/logs/app.log

# å‰ç«¯æ—¥å¿—
cd vue-frontend
pnpm dev  # å¼€å‘æ¨¡å¼ä¸‹æŸ¥çœ‹æ§åˆ¶å°
```

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€: [GitHub](https://github.com/githaohao/xzxz-lm)
- é¡¹ç›®åœ°å€: [Gitee](https://gitee.com/githaohao/xzxz-lm)
- é—®é¢˜åé¦ˆ: [Issues](https://gitee.com/githaohao/xzxz-lm/issues)

## è‡´è°¢

- [LM Studio](https://lmstudio.ai/) - æœ¬åœ°å¤§è¯­è¨€æ¨¡å‹æœåŠ¡
- [FunAudioLLM](https://github.com/FunAudioLLM/FunAudioLLM) - é«˜æ€§èƒ½è¯­éŸ³è¯†åˆ«å¼•æ“
- [shadcn-ui](https://ui.shadcn.com/) - ç°ä»£åŒ– UI ç»„ä»¶åº“
- [Vue 3](https://vuejs.org/) - æ¸è¿›å¼ JavaScript æ¡†æ¶
- [Qwen](https://github.com/QwenLM/Qwen) - é€šä¹‰åƒé—®å¤§è¯­è¨€æ¨¡å‹